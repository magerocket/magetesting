<!--[if IE]>
<style type="text/css" media="screen">
    th.compare-table-data-name {
        padding-top: 0;
        padding-bottom: 24px;
    }
</style>
<![endif]-->

<div class="row">
    <div class="span12">
        <h1>Plan Comparison and Pricing</h1>
        <?php $user = $this->user; ?>
        <?php if($user && $user->hasPlanActive() && (int)$user->getBraintreeTransactionConfirmed() && (int)$user->getAdditionalStores()): ?>
            <div class="alert alert-notice"><a class="close" data-dismiss="alert" href="#">&times;</a>You have additional stores purchased. During plan changing keep in mind that stores can have diffrent price in other plans.</div>
        <?php endif; ?>
        <table class="compare-table" style="margin-bottom: 20px">
            <thead>
                <tr class="compare-table-title-row">
                    <th class="compare-table-title-row"><span class="compare-table-title">Features</span></th>
                    <?php foreach($this->plans as $plan): ?>
                        <th class="compare-table-data-name">
                            <h3><span><?php echo $plan->getName(); ?></span></h3>
                            <h2><span class="compare-table-dollar">$</span><span><?php echo $plan->getPrice(); ?></span></h2>
                            <h4><span><?php echo $plan->getPriceDescription(); ?></span></h4>
                        </th>
                        <th class="compare-table-empty-first"><span class="compare-table-empty"></span></th>
                    <?php endforeach; ?>
                </tr>
            </thead>
            <tbody>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Multiple Extension Testing" data-content="Install multiple extensions for performance compatibility or test drive purposes.">
                            <i class="icon icon-blue icon-info-sign"></i> Multiple Extension Testing
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="One-click Extension install" data-content="Single click extension installation. No need for knowing FTP process or file structure.">
                            <i class="icon icon-blue icon-info-sign"></i> One-click Extension install
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Purchase Tested Extensions" data-content="Once an extension is purchased you get an additional 7 day pass to Sandbox Exploration to access code and deploy to store site.">
                            <i class="icon icon-blue icon-info-sign"></i> Purchase Tested Extensions
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Rollback Capabilities" data-content="If you want to uninstall an extension you can rollback and install a different extension instead.">
                            <i class="icon icon-blue icon-info-sign"></i> Rollback Capabilities
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Direct Extension Deployment" data-content="You can easily download package containing installed extension to apply changes on your live site.">
                            <i class="icon icon-blue icon-info-sign"></i> Direct Extension Deployment
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Real-time log files" data-content="Store logs are accessible in Papertrail for easy and fast debug.">
                            <i class="icon icon-blue icon-info-sign"></i> Real-time log files
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="FTP Access" data-content="You can get an FTP access to your store files to make any manual changes you need.">
                            <i class="icon icon-blue icon-info-sign"></i> FTP Access
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getFtpAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/cancel.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Additional Stores" data-content="You can purchase additional stores to be used.">
                            <i class="icon icon-blue icon-info-sign"></i> Max Additional Stores
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                            <td class="compare-table-data"><?php echo $plan->getMaxStores(); ?></td>
                            <td class="compare-table-empty"></td>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Store Price" data-content="Standard price for one additional store for 10 days or 1 month depending on your selected plan.">
                            <i class="icon icon-blue icon-info-sign"></i> Price Per Additional Store
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                            <td class="compare-table-data">$<?php echo $plan->getStorePrice(); ?></td>
                            <td class="compare-table-empty"></td>
                    <?php endforeach; ?>
                </tr>
                <?php /*
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <i class="icon icon-blue icon-info-sign"></i> phpMyAdmin Access
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getPhpmyadminAccess()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/cancel.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>
                 * */ 
                ?>
                <?php /*
                <tr class="compare-table-row-title">
                    <td class="compare-table-row-title">
                        <i class="icon icon-blue icon-info-sign"></i> Custom Store Import
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <?php if((int)$plan->getCanAddCustomStore()): ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/accept.png') ?>" alt="Yes"></td>
                            <td class="compare-table-empty"></td>
                        <?php else: ?>
                            <td class="compare-table-data"><img src="<?php echo $this->baseUrl('public/img/32x32/cancel.png') ?>" alt="No"></td>
                            <td class="compare-table-empty"></td>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </tr>*/?>
                <tr class="compare-table-row-title compare-table-row-title-last">
                    <td class="compare-table-row-title  compare-table-row-title-last">
                        <div rel="popover" data-trigger="hover" data-placement="top" data-original-title="Access" data-content="">
                            <i class="icon icon-blue icon-info-sign"></i> Access
                        </div>
                    </td>
                    <?php foreach($this->plans as $plan): ?>
                        <td class="compare-table-data last-data"><?php echo $plan->getBillingDescription(); ?></td>
                        <td class="compare-table-empty last"></td>
                    <?php endforeach; ?>
                </tr>
                <tr class="compare-table-row-title-empty">
                    <td class="compare-table-price-empty empty-left"></td>
                    <?php $emptyCount = 0; ?>
                    <?php foreach($this->plans as $plan): ?>
                        <td class="compare-table-price-button">
                        <?php if(is_object($this->user)): ?>
                            <?php if ($this->user->getGroup() == 'admin'): ?>
                                <a href="<?php echo $this->url(array('module' => 'default',
                                    'controller' => 'plan',
                                    'action' => 'edit',
                                    'id' => $plan->getId()), 'default', true); ?>" class="btn btn-success btn-large"><i class="icon-white icon-pencil"></i>&nbsp;Edit</a>
                            <?php elseif($this->user->hasPlanActive() AND !(int)$this->user->getBraintreeTransactionConfirmed()): ?>
                            <button
                                type="button" 
                                <?php if($this->user->getBraintreeTransactionId()): ?>
                                title="Your payment for your current plan is being processed now. It make take up to 24 hours for this to complete.  You will be able to change your plan immediately after your initial payment has settled."
                                <?php endif; ?>
                                class="btn btn-large btn-success disabled subscribe-now">Subscribe Now</button>
                            <?php else: ?>
                            <form method="post" action="<?php echo $this->url(array('controller' => 'payment', 'action' => 'payment'), 'default', true); ?>">
                                <input type="hidden" name="pay-for" value="<?php echo ($this->user->hasPlanActive() ? 'change-plan' : 'plan'); ?>" />
                                <input type="hidden" name="source" value="plan" />
                                <input type="hidden" name="id" value="<?php echo $plan->getId(); ?>" />
                                <button type="submit" class="btn btn-large btn-success" <?php if($user->hasPlanActive() AND $plan->getId() == $user->getPlanId()){echo('disabled="disabled"');} ?>>Get Started</button>
                            </form>
                            <?php endif; ?>
                        <?php else: ?>
                            <?php $this->getHelper('ServerUrl')->setScheme('https'); ?>
                            <form method="post" action="<?php echo $this->serverUrl($this->url(array('controller' => 'user', 'action' => 'register'), 'default', true)); ?>">
                                <input type="hidden" name="preselected_plan_id" value="<?php echo $plan->getId(); ?>" />
                                <button type="submit" class="btn btn-large btn-success">Get Started</button>
                                <?php if(1 == $plan->getId() && !is_object($this->user)): ?>
                                <a href="#" class="free-trial">Request Free Trial</a>
                                <?php endif; ?>
                            </form>
                            <?php $this->getHelper('ServerUrl')->setScheme('http'); ?>
                        <?php endif;?>
                        </td>
                        <td class="compare-table-price-empty"></td>
                    <?php endforeach; ?>
                </tr>
            </tbody>
        </table>
        
        <div class="row in-all-plans">
            <h4><span>Included in all plans</span></h4>
            <ul>
            	<li><i class="icon icon-blue icon-ok"></i> Test in empty Magento store</li>
            	<li><i class="icon icon-blue icon-ok"></i> Test in demo Magento store</li>
            	<li><i class="icon icon-blue icon-ok"></i> Test your Magento store</li>
            	<li><i class="icon icon-blue icon-ok"></i> Single domain</li>
            	<li><i class="icon icon-blue icon-ok"></i> Free extension store</li>
            	<li><i class="icon icon-blue icon-ok"></i> Premium extension store</li>
            </ul>
            <div class="clearfix"></div>
            <h4 class="supported-magento-releases"><span>Supported Magento releases</span></h4>
            <ul>
                <?php
                    foreach($this->versions as $version) {
                ?>
                <li><i class="icon icon-blue icon-ok"></i> <?php echo $version->getEdition().' '.$version->getVersion(); ?></li>
                <?php
                    }
                ?>
            </ul>
        </div>
    </div>
</div>
<?php 
    $data = <<<EOT

EOT;
    echo $this->partial('_partials/helpContext.phtml', array('data' => $data)); 
?>
